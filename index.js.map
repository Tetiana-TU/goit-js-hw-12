{"version":3,"file":"index.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { createGalleryCardTemplate } from './js/render-functions';\nimport { fetchPhotosByQuery } from './js/pixabay-api';\n\nconst searchFormEl = document.querySelector('.js-search-form');\nconst galleryEl = document.querySelector('.js-gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtnEl = document.querySelector('.load-more-btn');\n\nlet page = 1;\nlet searchedQuery = '';\n\nconst onSearchFormSubmit = async event => {\n  try {\n    event.preventDefault();\n\n    searchedQuery = event.currentTarget.elements.user_query.value.trim();\n\n    if (searchedQuery === '') {\n      searchFormEl.reset();\n      iziToast.error({\n        message: 'Please enter your request',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    page = 1;\n\n    loadMoreBtnEl.classList.add('is-hidden');\n    loader.classList.remove('is-hidden');\n\n    const { data } = await fetchPhotosByQuery(searchedQuery, page);\n\n    if (data.total === 0) {\n      searchFormEl.reset();\n      iziToast.show({\n        message:\n          '\"Sorry, there are no images matching your search query. Please try again!\"',\n        position: 'topRight',\n      });\n\n      galleryEl.innerHTML = '';\n      searchFormEl.reset();\n      return;\n    }\n    if (data.totalHits > 1) {\n      loadMoreBtnEl.classList.remove('is-hidden');\n      loadMoreBtnEl.addEventListener('click', onLoadMoreBtnClick);\n    }\n\n    const galleryTemplate = data.hits\n      .map(el => createGalleryCardTemplate(el))\n      .join('');\n    galleryEl.innerHTML = galleryTemplate;\n    loader.classList.add('is-hidden');\n    scrollDown();\n    gallery.refresh();\n    searchFormEl.reset();\n  } catch (error){\n      loader.style.display = 'none';\n      iziToast.show({\n        message: 'error',\n        position: 'topRight',\n      });\n    };\n\n\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\n\nconst onLoadMoreBtnClick = async event => {\n  try {\n    page++;\n\n    const { data } = await fetchPhotosByQuery(searchedQuery, page);\n\n    const galleryTemplate = data.hits\n      .map(el => createGalleryCardTemplate(el))\n      .join('');\n\n    galleryEl.insertAdjacentHTML('beforeend', galleryTemplate);\n    scrollDown();\n    gallery.refresh();\n\n    if (page * 15 >= data.totalHits) {\n      loadMoreBtnEl.classList.add('is-hidden');\n      loadMoreBtnEl.removeEventListener('click', onLoadMoreBtnClick);\n      loader.style.display = 'none';\n    }\n  } catch (\n    error) {\n      iziToast.show({\n        message: 'error',\n        position: 'topRight',\n      });\n    };\n  }\n};\nfunction scrollDown() {\n  let cardHeight = document\n    .querySelector('.gallery-card')\n    .getBoundingClientRect().height;\n  console.log(document.body.scrollTop, Math.floor(cardHeight * 2));\n  window.scrollBy({\n    top: document.body.scrollTop + Math.floor(cardHeight * 2),\n    behavior: 'smooth',\n  });\n}\nconst gallery = new SimpleLightbox('.js-gallery a', {\n  captionDelay: 300,\n  captionsData: 'alt',\n});\n"],"names":["SimpleLightbox"],"mappings":"svBAOqB,SAAS,cAAc,iBAAiB,EAC3C,SAAS,cAAc,aAAa,EACvC,SAAS,cAAc,SAAS,EACzB,SAAS,cAAc,gBAAgB,EAsG7C,IAAIA,EAAe,gBAAiB,CAClD,aAAc,IACd,aAAc,KAChB,CAAC"}